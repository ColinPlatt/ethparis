<!DOCTYPE html><html><head><meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><title>Cacophony</title><style>.title { font-size: 1.5em;font-weight: 600;font-family: inherit;color: #000;margin: 0; }#header-bar { display: flex;justify-content: space-between;align-items: center;padding: 5px;height: 35px;position: fixed;top: 0;width: 100%;z-index: 999; }.top-right { display: flex;align-items: center;right: 15px;padding-right: 25px; }.dot { height: 10px;width: 10px;background-color: red;border-radius: 50%;margin-top: 10px;margin-right: 5px; }body { font-family: 'Helvetica', sans-serif; }.timeline { width: 1200px;margin: auto; }td[class^='slot-'] { background-color: #f0f0f0;border: 1px solid #ccc;width: 120px;height: 40px; }.samples { width: 1200px;display: flex; }td[class^='sample-'] { background-color: #f0f0f0;border: 1px solid #ccc;width: 120px;height: 40px; }div[class^='track-'] { grid-template-columns: repeat(10, 1fr);display: grid; }.selected { background-color: yellow !important; }.occupied { background-color: lightgreen !important; }</style></head><body><p>hello</p><div id="header-bar" ><div class="title" >Cacophony</div><div class="top-right"><div class="dot"></div><button class="connect-button">Connect Wallet</button><button class="switch-button">Switch Networks</button></div></div><div class="iframe-fallback"><span class="body">Please open original media to enable Web3 features</span></div><div id="web3-container" ><div class="title" ><h1 class="title" >Timeline</h1></div><table class="timeline" ><tr class="channel-0" ><td class="slot-0" ></td><td class="slot-1" ></td><td class="slot-2" ></td><td class="slot-3" ></td><td class="slot-4" ></td><td class="slot-5" ></td><td class="slot-6" ></td><td class="slot-7" ></td><td class="slot-8" ></td><td class="slot-9" ></td></tr><tr class="channel-0" ><td class="slot-0" ></td><td class="slot-1" ></td><td class="slot-2" ></td><td class="slot-3" ></td><td class="slot-4" ></td><td class="slot-5" ></td><td class="slot-6" ></td><td class="slot-7" ></td><td class="slot-8" ></td><td class="slot-9" ></td></tr><tr class="channel-0" ><td class="slot-0" ></td><td class="slot-1" ></td><td class="slot-2" ></td><td class="slot-3" ></td><td class="slot-4" ></td><td class="slot-5" ></td><td class="slot-6" ></td><td class="slot-7" ></td><td class="slot-8" ></td><td class="slot-9" ></td></tr><tr class="channel-0" ><td class="slot-0" ></td><td class="slot-1" ></td><td class="slot-2" ></td><td class="slot-3" ></td><td class="slot-4" ></td><td class="slot-5" ></td><td class="slot-6" ></td><td class="slot-7" ></td><td class="slot-8" ></td><td class="slot-9" ></td></tr></table><div class="sample-container" ><div class="title" ><h1 >Samples</h1></div><div class="description" ><p >Click on a sample to select it, then click on a slot on the timeline to assign it to that slot.</p></div><table class="samples" ><tr ><td class="sample-0" ></td><td class="sample-1" ></td><td class="sample-2" ></td><td class="sample-3" ></td><td class="sample-4" ></td><td class="sample-5" ></td><td class="sample-6" ></td><td class="sample-7" ></td><td class="sample-8" ></td><td class="sample-9" ></td></tr></table><button id="update-btn" >Update</button></div></div><script>let isIframe; let provider; let accounts; let connectedAccount; function setDotColor(e) {document.querySelector(".dot").style.backgroundColor = e} document.addEventListener("DOMContentLoaded", function () {if (window == window.top) {provider = window.ethereum; isIframe = false; var e = document.getElementById("web3-container", document.querySelector(".iframe-fallback").style.display = "none"),t = document.querySelector(".connect-button"), n = document.querySelector(".switch-button"); e.style.display = "block",void 0 !== provider ? (window.ethereum.request({method: "eth_requestAccounts"}), ethereum.request({method: "eth_accounts"}).then(function (accounts) {accounts.length === 0 ? (setDotColor("red"), t.style.display = "block", n.style.display = "none") : ethereum.request({method: "eth_chainId"}).then(function (e) {if("0x5" === e) { (ethereum.enable().then(function (accounts) { setDotColor("green"); console.log(accounts); connectedAccount = accounts[0]; n.style.display = "none"; t.innerText = "Connected"; }).catch(console.error))} else {(setDotColor("red"), t.style.display = "none", n.style.display = "block")} }).catch(console.error)}).catch(console.error), t.addEventListener("click", function () {ethereum.request({method: "eth_requestAccounts"}).then(function (accounts) {if(accounts.length > 0) {setDotColor("green"); t.innerText = "Connected"; n.style.display = "none"; connectedAccount = accounts[0]; } else { ethereum.enable().then(function (accounts) { setDotColor("green"); console.log(accounts); connectedAccount = accounts[0]; n.style.display = "none"; t.innerText = "Connected";}).catch(console.error); } }).catch(console.error)}), n.addEventListener("click", function () {window.ethereum.request({ method: "wallet_addEthereumChain", params: [{ chainId: "0x5", chainName: "Goerli", rpcUrls: ["https://eth-goerli.public.blastapi.io"], blockExplorerUrls: ["https://goerli.etherscan.io/"], nativeCurrency: { name: "ETH", symbol: "ETH", decimals: 18 } }]}).then(function () {n.style.display = "none"; setDotColor("green")}).catch(console.error)})) : (setDotColor("red"), t.style.display = "block", n.style.display = "none")} else {document.querySelector(".iframe-fallback").style.display = "block"; document.getElementById("web3-container").style.display = "none", isIframe = true;}});</script><script>function createWavFile(samples,sameRate){const byteRate = sameRate * 1;const dataSize = samples.length;const buffer = new ArrayBuffer(44 + dataSize);const view = new DataView(buffer);view.setUint32(0, 0x52494646, false); view.setUint32(4, 36 + dataSize, true); view.setUint32(8, 0x57415645, false); view.setUint32(12, 0x666d7420, false); view.setUint32(16, 16, true); view.setUint16(20, 1, true); view.setUint16(22, 1, true); view.setUint32(24, sameRate, true); view.setUint32(28, byteRate, true); view.setUint16(32, 1, true); view.setUint16(34, 8, true); view.setUint32(36, 0x64617461, false); view.setUint32(40, dataSize, true);for (let i = 0, stride = 44; i < dataSize; i++, stride++) {view.setUint8(stride, samples[i]);}return buffer;}function hexStringToUint8Array(hexString){const numPairs = hexString.length / 2;const uintArray = new Uint8Array(numPairs);for (let i = 0; i < numPairs; i++) {const hexPair = hexString.substr(i * 2, 2); uintArray[i] = parseInt(hexPair, 16);}return uintArray;}const samples = hexStringToUint8Array(samplesStr); const sampleRate = 8000; console.log(samples); const wavFile = createWavFile(samples, sampleRate); const blob = new Blob([wavFile], { type: 'audio/wav' }); const url = URL.createObjectURL(blob); const player = document.getElementById('player'); player.src = url; player.play();document.addEventListener('DOMContentLoaded', (event) => {const updateButton = document.getElementById('update-btn'); console.log(updateButton);updateButton.addEventListener('click', async function(){if (connectedAccount == undefined) {alert("Please connect your wallet first"); } else {const res = ethereum.request({"method":"eth_call","params":[{from: connectedAccount,to: "0x94c16a950d0e044ef12bbc1705c237d89474be5b",data: "0x20c50d810000000000000000000000000000000000000000000000000000000000000001"},"latest"]}); console.log("result", res);}});});</script></body></html>